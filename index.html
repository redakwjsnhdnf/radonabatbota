<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>The Void: Bio-Organic Terror</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; cursor: none; }
        canvas { display: block; filter: contrast(1.2) brightness(0.8) sepia(0.2); }
        #overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle, transparent 20%, rgba(0,0,0,0.9) 100%);
            pointer-events: none;
        }
        #grain {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://upload.wikimedia.org/wikipedia/commons/7/76/1k_Grain_Noise.png');
            opacity: 0.05; pointer-events: none; animation: noise 0.2s infinite;
        }
        @keyframes noise { 0% { transform: translate(0,0); } 100% { transform: translate(10px,10px); } }
    </style>
</head>
<body>

<div id="overlay"></div>
<div id="grain"></div>
<canvas id="render"></canvas>

<script>
const canvas = document.getElementById('render');
const ctx = canvas.getContext('2d');
let w = canvas.width = window.innerWidth;
let h = canvas.height = window.innerHeight;

let frame = 0;
const keys = {};

const ghost = {
    x: w/2, y: h-150, vx: 0, vy: 0,
    w: 50, h: 90, dir: 1,
    isJumping: false,
    pulse: 0
};

// --- إضاءة واقعية تتبع الماوس والشخصية ---
let mouse = { x: w/2, y: h/2 };
window.onmousemove = (e) => { mouse.x = e.clientX; mouse.y = e.clientY; };

function drawCinemaLighting() {
    // إضاءة كشاف (Flashlight) بأسلوب Resident Evil
    let flashlight = ctx.createRadialGradient(mouse.x, mouse.y, 10, mouse.x, mouse.y, 500);
    flashlight.addColorStop(0, 'rgba(255, 250, 220, 0.2)');
    flashlight.addColorStop(1, 'transparent');
    ctx.fillStyle = flashlight;
    ctx.globalCompositeOperation = 'screen';
    ctx.fillRect(0, 0, w, h);
    ctx.globalCompositeOperation = 'source-over';
}

function drawGhostRealistic() {
    ctx.save();
    ctx.translate(ghost.x, ghost.y);
    
    // أنيميشن القفز والفيزياء
    let tilt = ghost.vx * 0.05;
    ctx.rotate(tilt);
    
    // 1. العباءة (Textured Cloak)
    // العباءة دابا فيها طيات (Folds) وظلال واقعية
    let cloakGrad = ctx.createLinearGradient(-30, 0, 30, 100);
    cloakGrad.addColorStop(0, "#0a0a0a");
    cloakGrad.addColorStop(0.5, "#15151a");
    cloakGrad.addColorStop(1, "#050505");
    
    ctx.fillStyle = cloakGrad;
    ctx.beginPath();
    ctx.moveTo(-28, 0);
    // رسم حواف ممزقة برمجياً
    for(let i=0; i<=10; i++) {
        let x = -28 + i*5.6;
        let noise = Math.sin(frame*0.1 + i) * 3;
        ctx.lineTo(x, 100 + noise + (Math.abs(ghost.vx)*2));
    }
    ctx.lineTo(28, 0);
    ctx.fill();

    // 2. الماسك (Bone/Porcelain Texture)
    // الماسك فيه تدرج ضل (Ambient Occlusion)
    let maskGrd = ctx.createRadialGradient(-10, -25, 0, 0, -20, 40);
    maskGrd.addColorStop(0, "#e0e0e0");
    maskGrd.addColorStop(0.8, "#808085");
    maskGrd.addColorStop(1, "#303035");
    
    ctx.fillStyle = maskGrd;
    ctx.shadowBlur = 15;
    ctx.shadowColor = "rgba(0,0,0,0.5)";
    ctx.beginPath();
    ctx.ellipse(0, -20, 26, 34, 0, 0, Math.PI*2);
    ctx.fill();

    // 3. العيون (Void Abyss)
    // العين دابا فيها توهج داخلي خافت (Eerie Glow)
    ctx.shadowBlur = 0;
    ctx.fillStyle = "#000";
    ctx.beginPath();
    ctx.ellipse(-9, -18, 7, 13, 0.1, 0, Math.PI*2);
    ctx.ellipse(9, -18, 7, 13, -0.1, 0, Math.PI*2);
    ctx.fill();
    
    // بريق العين "الميت"
    ctx.fillStyle = "rgba(255,255,255,0.05)";
    ctx.beginPath(); ctx.arc(-9, -22, 2, 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(9, -22, 2, 0, Math.PI*2); ctx.fill();

    // 4. القرون (Cinematic Horns)
    ctx.fillStyle = "#d0d0d5";
    ctx.beginPath();
    ctx.moveTo(-15, -45); ctx.bezierCurveTo(-45, -90, -10, -100, -5, -55);
    ctx.moveTo(15, -45); ctx.bezierCurveTo(45, -90, 10, -100, 5, -55);
    ctx.fill();

    ctx.restore();
}

function drawEnvironment() {
    // أرضية "رطبة" تعكس الضوء
    let floorGrad = ctx.createLinearGradient(0, h-100, 0, h);
    floorGrad.addColorStop(0, "#050508");
    floorGrad.addColorStop(1, "#000");
    ctx.fillStyle = floorGrad;
    ctx.fillRect(0, h-100, w, 100);

    // ضباب (Volumetric Fog)
    ctx.globalAlpha = 0.2;
    for(let i=0; i<3; i++) {
        let x = (frame * (i+1) * 0.5) % w;
        ctx.fillStyle = "#222530";
        ctx.fillRect(x, h-150, 400, 100);
        ctx.fillRect(x - w, h-150, 400, 100);
    }
    ctx.globalAlpha = 1.0;
}

function loop() {
    // تأثير "العين السينمائية" (Motion Blur)
    ctx.fillStyle = "rgba(5, 5, 10, 0.4)";
    ctx.fillRect(0, 0, w, h);

    drawEnvironment();
    drawGhostRealistic();
    drawCinemaLighting();

    // الفيزياء
    ghost.vy += 0.8;
    ghost.y += ghost.vy;
    ghost.x += ghost.vx;

    if(ghost.y > h - 150) { ghost.y = h - 150; ghost.vy = 0; ghost.isJumping = false; }

    if(keys.ArrowRight || keys.KeyD) { ghost.vx = 5; ghost.dir = 1; }
    else if(keys.ArrowLeft || keys.KeyA) { ghost.vx = -5; ghost.dir = -1; }
    else { ghost.vx *= 0.8; }

    frame++;
    requestAnimationFrame(loop);
}

window.onkeydown = e => {
    keys[e.code] = true;
    if(e.code === 'Space' && !ghost.isJumping) { ghost.vy = -16; ghost.isJumping = true; }
};
window.onkeyup = e => keys[e.code] = false;

loop();
</script>
</body>
</html>
