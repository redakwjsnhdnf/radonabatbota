<!DOCTYPE html>
<html>
<head>
    <title>Roblox Clone JS</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; }
        #instructions {
            position: absolute; top: 10px; left: 10px;
            color: white; font-family: sans-serif;
            background: rgba(0,0,0,0.5); padding: 10px;
        }
    </style>
</head>
<body>
    <div id="instructions">WASD للتحرك | SPACE للقفز</div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        // 1. إعداد المشهد (Scene)
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x87ceeb); // سماء زرقاء

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.shadowMap.enabled = true;
        document.body.appendChild(renderer.domElement);

        // 2. الإضاءة (Lights)
        const light = new THREE.DirectionalLight(0xffffff, 1);
        light.position.set(10, 20, 10);
        light.castShadow = true;
        scene.add(light);
        scene.add(new THREE.AmbientLight(0x404040));

        // 3. الأرضية (Baseplate)
        const floorGeo = new THREE.BoxGeometry(100, 1, 100);
        const floorMat = new THREE.MeshStandardMaterial({ color: 0x333333 });
        const floor = new THREE.Mesh(floorGeo, floorMat);
        floor.receiveShadow = true;
        floor.position.y = -0.5;
        scene.add(floor);

        // 4. صناعة شخصية روبلوكس (The Character)
        const playerGroup = new THREE.Group();
        
        // الرأس
        const head = new THREE.Mesh(new THREE.BoxGeometry(0.5, 0.5, 0.5), new THREE.MeshStandardMaterial({color: 0xffdbac}));
        head.position.y = 1.6;
        playerGroup.add(head);

        // الجسم (Torso)
        const torso = new THREE.Mesh(new THREE.BoxGeometry(0.8, 1, 0.4), new THREE.MeshStandardMaterial({color: 0x0000ff}));
        torso.position.y = 0.9;
        playerGroup.add(torso);

        // الأرجل
        const legGeo = new THREE.BoxGeometry(0.35, 0.8, 0.35);
        const lLeg = new THREE.Mesh(legGeo, new THREE.MeshStandardMaterial({color: 0x111111}));
        lLeg.position.set(-0.2, 0.4, 0);
        playerGroup.add(lLeg);
        
        const rLeg = new THREE.Mesh(legGeo, new THREE.MeshStandardMaterial({color: 0x111111}));
        rLeg.position.set(0.2, 0.4, 0);
        playerGroup.add(rLeg);

        scene.add(playerGroup);

        // 5. نظام التحكم
        const keys = {};
        let velocityY = 0;
        let isJumping = false;

        window.addEventListener('keydown', (e) => keys[e.code] = true);
        window.addEventListener('keyup', (e) => keys[e.code] = false);

        function update() {
            const speed = 0.15;
            if (keys['KeyW']) playerGroup.translateZ(-speed);
            if (keys['KeyS']) playerGroup.translateZ(speed);
            if (keys['KeyA']) playerGroup.rotation.y += 0.05;
            if (keys['KeyD']) playerGroup.rotation.y -= 0.05;

            // نظام القفز والجاذبية
            if (keys['Space'] && !isJumping) {
                velocityY = 0.2;
                isJumping = true;
            }
            
            playerGroup.position.y += velocityY;
            if (playerGroup.position.y > 0) {
                velocityY -= 0.01; // الجاذبية
            } else {
                playerGroup.position.y = 0;
                velocityY = 0;
                isJumping = false;
            }

            // الكاميرا تتبع اللاعب (Third Person)
            const relativeCameraOffset = new THREE.Vector3(0, 3, 7);
            const cameraOffset = relativeCameraOffset.applyMatrix4(playerGroup.matrixWorld);
            camera.position.x = cameraOffset.x;
            camera.position.y = cameraOffset.y;
            camera.position.z = cameraOffset.z;
            camera.lookAt(playerGroup.position);
        }

        function animate() {
            requestAnimationFrame(animate);
            update();
            renderer.render(scene, camera);
        }

        animate();
    </script>
</body>
</html>
