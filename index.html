<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>REDA WORLD - Phase 7 (ULTRA VFX)</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: 'Courier New', monospace; }
        #ui { position: absolute; top: 10px; left: 10px; color: #0f0; background: rgba(0,0,0,0.8); padding: 15px; border: 1px solid #0f0; z-index: 10; }
        #boss-health { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); width: 400px; height: 15px; background: #222; border: 2px solid #f00; display: none; }
        #boss-fill { width: 100%; height: 100%; background: linear-gradient(90deg, #ff0000, #ff5555); }
    </style>
</head>
<body>
    <div id="ui">
        <b>SYSTEM: REDA_OS v1.0</b><br>
        KILLS: <span id="kills">0</span><br>
        STATUS: <span id="status">EXPLORING</span>
    </div>
    <div id="boss-health"><div id="boss-fill"></div></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        window.onload = () => {
            const scene = new THREE.Scene();
            scene.background = new THREE.Color(0x050505);
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // إضاءة النيون (Cyberpunk Style)
            const light = new THREE.PointLight(0x00ffcc, 1, 100);
            light.position.set(0, 10, 0);
            scene.add(light, new THREE.AmbientLight(0x404040));

            // الأرضية (Grid Neon)
            const grid = new THREE.GridHelper(200, 40, 0x00ffcc, 0x003333);
            scene.add(grid);

            // اللاعب
            const player = new THREE.Group();
            const pBody = new THREE.Mesh(new THREE.BoxGeometry(0.6, 1.5, 0.4), new THREE.MeshPhongMaterial({color: 0x00ffcc}));
            pBody.position.y = 0.75;
            player.add(pBody);
            scene.add(player);

            let enemies = [];
            let killCount = 0;
            let shakeTime = 0;

            function spawnEnemy() {
                const enemy = new THREE.Mesh(new THREE.BoxGeometry(1, 1, 1), new THREE.MeshPhongMaterial({color: 0xff0055, emissive: 0xff0055}));
                enemy.position.set(Math.random()*60-30, 0.5, Math.random()*60-30);
                scene.add(enemy);
                enemies.push(enemy);
            }
            for(let i=0; i<10; i++) spawnEnemy();

            // دالة اهتزاز الكاميرا
            function triggerShake() { shakeTime = 0.3; }

            window.onclick = () => {
                triggerShake(); // اهتزاز عند كل ضربة
                enemies.forEach((enemy, index) => {
                    if(player.position.distanceTo(enemy.position) < 4) {
                        createExplosion(enemy.position);
                        scene.remove(enemy);
                        enemies.splice(index, 1);
                        killCount++;
                        document.getElementById('kills').innerText = killCount;
                        spawnEnemy();
                    }
                });
            };

            // نظام الانفجار (Particles)
            function createExplosion(pos) {
                for(let i=0; i<10; i++) {
                    const p = new THREE.Mesh(new THREE.BoxGeometry(0.2, 0.2, 0.2), new THREE.MeshBasicMaterial({color: 0xff0055}));
                    p.position.copy(pos);
                    scene.add(p);
                    const dir = new THREE.Vector3(Math.random()-0.5, Math.random(), Math.random()-0.5).normalize();
                    const speed = 0.2;
                    const interval = setInterval(() => {
                        p.position.addScaledVector(dir, speed);
                        p.scale.multiplyScalar(0.9);
                        if(p.scale.x < 0.01) { scene.remove(p); clearInterval(interval); }
                    }, 16);
                }
            }

            const keys = {};
            window.onkeydown = (e) => keys[e.code] = true;
            window.onkeyup = (e) => keys[e.code] = false;

            function animate() {
                requestAnimationFrame(animate);
                if (keys['KeyW']) player.translateZ(-0.25);
                if (keys['KeyS']) player.translateZ(0.25);
                if (keys['KeyA']) player.rotation.y += 0.05;
                if (keys['KeyD']) player.rotation.y -= 0.05;

                // تطبيق اهتزاز الكاميرا
                let sx = 0, sy = 0;
                if(shakeTime > 0) {
                    sx = (Math.random() - 0.5) * 0.5;
                    sy = (Math.random() - 0.5) * 0.5;
                    shakeTime -= 0.02;
                }

                const offset = new THREE.Vector3(sx, 5 + sy, 10).applyMatrix4(player.matrixWorld);
                camera.position.lerp(offset, 0.1);
                camera.lookAt(player.position.x, player.position.y + 1, player.position.z);
                renderer.render(scene, camera);
            }
            animate();
        };
    </script>
</body>
</html>
