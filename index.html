<!DOCTYPE html>
<html>
<head>
    <title>REDA CRAFT PRO</title>
    <style>
        body { margin: 0; overflow: hidden; background: #87CEEB; }
        #crosshair { position: absolute; top: 50%; left: 50%; width: 16px; height: 16px; border: 2px solid white; transform: translate(-50%, -50%); pointer-events: none; }
        #toolbar { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); display: flex; gap: 5px; background: rgba(0,0,0,0.5); padding: 5px; }
        .slot { width: 40px; height: 40px; border: 2px solid #333; background-size: cover; }
        .selected { border-color: white; }
    </style>
</head>
<body>
    <div id="crosshair"></div>
    <div id="toolbar">
        <div class="slot selected" style="background-image:url('https://minecraft.wiki/images/thumb/Grass_Block_JE4_BE3.png/150px-Grass_Block_JE4_BE3.png')"></div>
        <div class="slot" style="background-image:url('https://minecraft.wiki/images/thumb/Dirt_JE2_BE2.png/150px-Dirt_JE2_BE2.png')"></div>
        <div class="slot" style="background-image:url('https://minecraft.wiki/images/thumb/Stone_JE2_BE2.png/150px-Stone_JE2_BE2.png')"></div>
    </div>

<script type="module">
import * as THREE from 'https://cdn.skypack.dev/three@0.132.2';

const scene = new THREE.Scene();
scene.background = new THREE.Color(0x87CEEB);
scene.fog = new THREE.Fog(0x87CEEB, 10, 50);

const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({ antialias: false });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

// تحميل الصور (Textures)
const loader = new THREE.TextureLoader();
const loadTex = (url) => {
    const tex = loader.load(url);
    tex.magFilter = THREE.NearestFilter; // هاد السطر كيعطي داك الشكل ديال Pixel Art بحال ماين كرافت
    return tex;
};

const textures = {
    grass: [
        new THREE.MeshLambertMaterial({map: loadTex('https://raw.githubusercontent.com/mrdoob/three.js/master/examples/textures/minecraft/grass_dirt.jpg')}), // side
        new THREE.MeshLambertMaterial({map: loadTex('https://raw.githubusercontent.com/mrdoob/three.js/master/examples/textures/minecraft/grass.jpg')}),      // top
        new THREE.MeshLambertMaterial({map: loadTex('https://raw.githubusercontent.com/mrdoob/three.js/master/examples/textures/minecraft/dirt.jpg')})       // bottom
    ]
};

const blocks = [];
const worldSize = 20;

// توليد عالم "تضاريسي" بسيط
for(let x = -worldSize; x < worldSize; x++) {
    for(let z = -worldSize; z < worldSize; z++) {
        const h = Math.floor(Math.sin(x/5) * Math.cos(z/5) * 2) + 2;
        for(let y = 0; y < h; y++) {
            const geo = new THREE.BoxGeometry(1, 1, 1);
            const mesh = new THREE.Mesh(geo, y === h-1 ? textures.grass : textures.grass[2]);
            mesh.position.set(x, y, z);
            scene.add(mesh);
            blocks.push(mesh);
        }
    }
}

const light = new THREE.AmbientLight(0xffffff, 0.8);
scene.add(light);
const dLight = new THREE.DirectionalLight(0xffffff, 0.4);
dLight.position.set(10, 20, 10);
scene.add(dLight);

camera.position.set(0, 5, 5);

// نظام التحكم الاحترافي
let moveF = false, moveB = false, moveL = false, moveR = false;
document.addEventListener('keydown', (e) => {
    if(e.code === 'KeyW') moveF = true;
    if(e.code === 'KeyS') moveB = true;
    if(e.code === 'KeyA') moveL = true;
    if(e.code === 'KeyD') moveR = true;
});
document.addEventListener('keyup', (e) => {
    if(e.code === 'KeyW') moveF = false;
    if(e.code === 'KeyS') moveB = false;
    if(e.code === 'KeyA') moveL = false;
    if(e.code === 'KeyD') moveR = false;
});

document.addEventListener('click', () => document.body.requestPointerLock());
document.addEventListener('mousemove', (e) => {
    if(document.pointerLockElement) {
        camera.rotation.y -= e.movementX * 0.002;
        camera.rotation.x -= e.movementY * 0.002;
        camera.rotation.x = Math.max(-Math.PI/2, Math.min(Math.PI/2, camera.rotation.x));
    }
});

function animate() {
    requestAnimationFrame(animate);
    const speed = 0.1;
    if(moveF) camera.translateZ(-speed);
    if(moveB) camera.translateZ(speed);
    if(moveL) camera.translateX(-speed);
    if(moveR) camera.translateX(speed);
    renderer.render(scene, camera);
}
animate();
</script>
</body>
</html>
