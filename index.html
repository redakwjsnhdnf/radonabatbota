<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>THE SILENCE</title>
    <style>
        body { margin: 0; background: #000; overflow: hidden; display: flex; align-items: center; justify-content: center; height: 100vh; cursor: none; }
        #core {
            width: 10px; height: 10px; background: #ffb7c5; border-radius: 50%;
            box-shadow: 0 0 50px #ffb7c5; transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        #message {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: #ffb7c5; font-family: 'serif'; letter-spacing: 20px;
            opacity: 0; transition: 2s; pointer-events: none; text-align: center;
        }
        #cursor {
            position: fixed; width: 2px; height: 20px; background: #ffb7c5; pointer-events: none;
        }
    </style>
</head>
<body>
    <div id="cursor"></div>
    <div id="core"></div>
    <div id="message">الصمت هو لغة الخلود</div>

    <script>
        const core = document.getElementById('core');
        const msg = document.getElementById('message');
        const cursor = document.getElementById('cursor');

        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY - 10 + 'px';
        });

        // طلب الوصول للميكروفون لتحليل مستوى الصوت
        navigator.mediaDevices.getUserMedia({ audio: true })
        .then(stream => {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const analyser = audioContext.createAnalyser();
            const microphone = audioContext.createMediaStreamSource(stream);
            const javascriptNode = audioContext.createScriptProcessor(2048, 1, 1);

            analyser.smoothingTimeConstant = 0.8;
            analyser.fftSize = 1024;
            microphone.connect(analyser);
            analyser.connect(javascriptNode);
            javascriptNode.connect(audioContext.destination);

            javascriptNode.onaudioprocess = () => {
                const array = new Uint8Array(analyser.frequencyBinCount);
                analyser.getByteFrequencyData(array);
                let values = 0;
                for (let i = 0; i < array.length; i++) values += array[i];
                const average = values / array.length;

                // إذا كان الجو هادئاً، يكبر القلب وتظهر الرسالة
                if (average < 10) { 
                    core.style.transform = 'scale(20)';
                    msg.style.opacity = '0.5';
                    core.style.boxShadow = '0 0 100px #ffb7c5';
                } else {
                    // إذا كان هناك ضجيج، ينكمش الموقع ويختفي
                    core.style.transform = `scale(${Math.max(1, 10 - average/5)})`;
                    msg.style.opacity = '0';
                    core.style.boxShadow = 'none';
                }
            };
        })
        .catch(err => {
            console.log("الموقع يحتاج للصمت ليظهر.");
            msg.innerHTML = "أعط الصلاحية للميكروفون لتجربة الصمت";
            msg.style.opacity = "1";
        });
    </script>
</body>
</html>
